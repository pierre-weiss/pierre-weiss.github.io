<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head>


	<meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8"><title></title>
	
	<meta name="GENERATOR" content="LibreOffice 3.3  (Linux)">
	<meta name="AUTHOR" content="paw ">
	<meta name="CREATED" content="20110808;17021800">
	<meta name="CHANGEDBY" content="paw ">
	<meta name="CHANGED" content="20110809;18090500">
	<meta name="CHANGEDBY" content="paw ">
	<meta name="CHANGEDBY" content="paw ">
	<meta name="CHANGEDBY" content="paw "><style type="text/css">
	<!--
		@page { margin: 2.01cm }
		P { margin-bottom: 0.2cm }
		A:link { so-language: zxx }
	-->
	</style>
<meta name="CHANGEDBY" content="paw "><meta name="CHANGEDBY" content="paw "></head><body dir="ltr" lang="fr-FR"><p><span style="color: rgb(0, 0, 160);"><a style="font-size: 14pt;">VSNR: Variational Stationary Noise Remover. Examples of applications 
</a><a href="3rdLightSheet_PWeiss.pdf"> (slides) </a> <a href="VSNR.zip"> (codes)</a></span></p>
<p>Cite this work :</p>
<p>Variational algorithms to remove stationary noise. Application to
    microscopy imaging.<br>

J. Fehrenbach, P. Weiss and C. Lorenzo, IEEE
    Image Processing Vol. 21, Issue 10, pages 4420 - 4430, October (2012). <br>
<span style="color: rgb(0, 0, 160);"></span></p>
<span style="text-decoration: underline;"><br>
</span>



<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%You can find all the functions below in the zip-file.
</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%%
BLONDE TEST</font></font></font></p>

<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">clear
all;close all;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Initializes the random number generator</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">rng(2);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Loads and normalizes image</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">im=double(imread(</font><font color="#a020f0">'Blonde.png'</font><font color="#000000">));</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">im=im/255;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Adds noisy lines to the image</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">sigma=0.3;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">imb=im;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">[nx,ny,m]=size(im);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#0000ff">for</font><font color="#000000">
i=1:nx</font></font></font></p>
<p style="margin-bottom: 0cm; margin-left: 2em;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">  imb(i,:,1)=im(i,:,1)+sigma*randn;</font></font></font></p>
<p style="margin-bottom: 0cm; margin-left: 2em;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">  imb(i,:,2)=im(i,:,2)+sigma*randn;</font></font></font></p>
<p style="margin-bottom: 0cm; margin-left: 2em;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">  imb(i,:,3)=im(i,:,3)+sigma*randn;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#0000ff"><font face="lucidatypewriter, monospace"><font size="2">end</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Display</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">figure(1);image(uint8(255*imb));title(</font><font color="#a020f0">'Noisy
image'</font><font color="#000000">)</font></font></font></p>
<p style="margin-bottom: 0cm;"><span id="Cadre1" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
	<img src="Blonde.png" name="images9" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Original
	image</i></font>
</span>
<span id="Cadre2" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
	<img src="BlondeNoisy.png" name="images10" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Noisy
	image</i></font>
</span><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>

<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Defines the filter (a line)</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">filter=zeros(size(im));</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">filter(1,:)=1/size(im,1);</font></font></font></p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Denoising algorithm</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">x=zeros(size(im));</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#0000ff">for</font><font color="#000000">
i=1:3</font></font></font></p>
<p style="margin-bottom: 0cm; margin-left: 2em;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">ub=imb(:,:,i);
</font><font color="#228b22">% Treats every components separately</font></font></font></p>
<p style="margin-bottom: 0cm; margin-left: 2em;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">[y,Gap1,Primal1,Dual1,EstP1,EstD1]=VSNR(ub,0,2,filter,4e-4,1000,1e-3,1000); </font></font></font></p>
<p style="margin-bottom: 0cm; margin-left: 2em;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">x(:,:,i)=y;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#0000ff"><font face="lucidatypewriter, monospace"><font size="2">end</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Display the result (sometimes she will have a sunburst)</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">figure(2);image(uint8(255*x));title(</font><font color="#a020f0">'Denoised
image'</font><font color="#000000">);</font></font></font></p>

<p style="margin-bottom: 0cm;"><span id="Cadre3" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
	<img src="BlondeNoisy.png" name="images11" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Noisy
	image (PSNR = 16,5dB)</i></font>
</span>
<span id="Cadre4" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
	<img src="BlondeDenoised.png" name="images12" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Denoised (PSNR = 32,3dB)</i></font>
</span><br>
</p>

<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%%
BABOON TEST</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Load and normalize image.</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">clear
all;close all;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">im=double(imread(</font><font color="#a020f0">'mandril_gray.tif'</font><font color="#000000">))/255;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Seeds the random number generator (to produce identical experiments
each time)</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">rng(3);
</font></font></font>
</p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
Generates noise patterns.</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%
First, an isotropic sinc convolved with Gaussian noise.</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">[ny,nx]=size(im);
</font><font color="#228b22">% generates a sinc</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">[X,Y]=meshgrid(linspace(-1,1,nx),linspace(-1,1,ny));</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">R=100*sqrt(X.^2+Y.^2);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">psi1=sin(R)./(R+1e-10);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">psi1=1e-2*psi1/max(psi1(:));
</font><font color="#228b22">% Normalization</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">b1=randn(size(im));
</font><font color="#228b22">%Gaussian process</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">bpsi1=ifft2(fft2(b1).*fft2(psi1));
</font><font color="#228b22">%convolution of b1 and psi1</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Second,
a Gabor function convolved with a Bernoulli process</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">psi2=gabor_fn(1,pi,0,0,1,0.05);
</font><font color="#228b22">% a Gabor function</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">psi2=ZeroAdd(psi2,im);
</font><font color="#228b22">%padds with zeros</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">psi2=1e-2*psi2/max(psi2(:));
</font><font color="#228b22">%Normalization</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">b2=rand(size(im));
</font><font color="#228b22">%generates a Bernoulli process</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">b2=double(b2&gt;0.999);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">bpsi2=ifft2(fft2(b2).*fft2(psi2));
</font><font color="#228b22">%convolution of b2 with psi2</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Create
noisy imagge</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">imb=im+bpsi1+50*bpsi2;</font></font></font></p>


<p style="margin-bottom: 0cm;"><span id="Cadre1" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
	<img src="Baboon_real.png" name="images2" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Original
	image</i></font>
</span>
<span id="Cadre2" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
	<img src="Baboon_Bruite.png" name="images1" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Noisy</i></font>
</span><br>
</p>

<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>
<p style="margin-bottom: 0cm;"><br>
</p>

<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Stores
the filters in a single array.</font></font></font> 
</p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">Gabors=zeros(ny,nx,2);</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">Gabors(:,:,1)=psi1;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">Gabors(:,:,2)=psi2;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%%
Denoising and display</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Denoises
using a primal-dual algorithm.</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Sets
parameters</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">p=[2,1];
</font><font color="#228b22">%(indexes of p-norms)</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">alpha=[0.12,0.05];
</font><font color="#228b22">%data terms.</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">epsilon
= 0; </font><font color="#228b22">%no regularization of TV-norm</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">prec=
5e-3; </font><font color="#228b22">%stopping criterion (initial dual
gap multiplied by prec)</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">maxit=
500; </font><font color="#228b22">%maximum iterations number
</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">C
= 1; </font><font color="#228b22">%ball-diameter to define a
restricted duality gap. </font></font></font>
</p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Main
algorithm</font></font></font></p>
<p style="margin-bottom: 0cm;"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%You can use the Matlab implementation:
</font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">tic;</font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">[u,Gap,Primal,Dual,EstP,EstD]=VSNR(imb,epsilon,p,Gabors,alpha,maxit+1,prec,C);</font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">toc;</font></font></font></font></font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Or the C implementation:
</font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">tic;</font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">[u,Gap,Primal,Dual,EstP,EstD]=VSNR_c(imb,epsilon,p,Gabors,alpha,maxit+1,prec,C);</font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">toc;</font></font></font></font></font></font></font></font></font></font></font></font></font></p>

<p style="margin-bottom: 0cm;"><span id="Cadre3" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2">	<img src="Baboon_real.png" name="images2" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Original image</i></font>
</font></font></font></font></font></font></font></font></font></font></font></font></span>
<span id="Cadre4" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2">	<img src="Baboon_algo.png" name="images1" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Restored image</i></font>
</font></font></font></font></font></font></font></font></font></font></font></font></span><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>


<p style="margin-bottom: 0cm;"></p>
<p style="margin-bottom: 0cm;"></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">
%Retrieving noise components (EstP contains the estimation of noise processes)</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">cp1=-ifft2(fft2(EstP(:,:,1)).*fft2(psi1));</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000"><font face="lucidatypewriter, monospace"><font size="2">cp2=-ifft2(fft2(EstP(:,:,2)).*fft2(psi2));</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>

<p style="margin-bottom: 0cm;"><span id="Cadre5" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2">	<img src="Baboon_real_B1.png" name="images2" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>First component</i></font>
</font></font></font></font></font></font></font></font></font></font></font></font></span>
<span id="Cadre6" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2">	<img src="Baboon_algo_B1.png" name="images1" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Retrieved first component</i></font>
</font></font></font></font></font></font></font></font></font></font></font></font></span><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>

<p style="margin-bottom: 0cm;"><span id="Cadre7" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2">	<img src="Baboon_real_B2.png" name="images2" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Second component</i></font>
</font></font></font></font></font></font></font></font></font></font></font></font></span>
<span id="Cadre8" dir="ltr" style="border: medium none ; padding: 0cm; background: rgb(255, 255, 255) none repeat scroll 0%; float: left; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2">	<img src="Baboon_algo_B2.png" name="images1" align="left" border="0" height="256" width="256"><br clear="left"><font size="3"><i>Retrieved 2nd component</i></font>
</font></font></font></font></font></font></font></font></font></font></font></font></span><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>

<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#228b22"><font face="lucidatypewriter, monospace"><font size="2">%Displaying
the whole</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">figure(1);colormap
</font><font color="#a020f0">gray</font><font color="#000000">;imagesc(imb);title(</font><font color="#a020f0">'Noisy
image'</font><font color="#000000">)</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">figure(2);colormap
</font><font color="#a020f0">gray</font><font color="#000000">;imagesc(u);title(</font><font color="#a020f0">'Restored
image'</font><font color="#000000">)</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewrter, monospace"><font size="2"><font color="#000000">figure(3);colormap
</font><font color="#a020f0">gray</font><font color="#000000">;imagesc(bpsi1);title(</font><font color="#a020f0">'First
noise component - real'</font><font color="#000000">)</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">figure(4);colormap
</font><font color="#a020f0">gray</font><font color="#000000">;imagesc(cp1);title(</font><font color="#a020f0">'First
noise component - estimated'</font><font color="#000000">)</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">figure(5);colormap
</font><font color="#a020f0">gray</font><font color="#000000">;imagesc(bpsi2);title(</font><font color="#a020f0">'Second
noise component - real'</font><font color="#000000">)</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font color="#000000">figure(6);colormap
</font><font color="#a020f0">gray</font><font color="#000000">;imagesc(cp2);title(</font><font color="#a020f0">'Second
noise component - estimated'</font><font color="#000000">)</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>
<p style="margin-bottom: 0cm;"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><font face="lucidatypewriter, monospace"><font size="2"><br>
</font></font></font></font></font></font></font></font></font></font></font></font></p>

</body></html>