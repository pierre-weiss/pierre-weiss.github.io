<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="LibreOffice 3.3  (Linux)">
	<META NAME="AUTHOR" CONTENT="paw ">
	<META NAME="CREATED" CONTENT="20110808;17021800">
	<META NAME="CHANGEDBY" CONTENT="paw ">
	<META NAME="CHANGED" CONTENT="20110809;18090500">
	<META NAME="CHANGEDBY" CONTENT="paw ">
	<META NAME="CHANGEDBY" CONTENT="paw ">
	<META NAME="CHANGEDBY" CONTENT="paw "><STYLE TYPE="text/css">
	<!--
		@page { margin: 2.01cm }
		P { margin-bottom: 0.2cm }
		A:link { so-language: zxx }
	-->
	</STYLE>
</HEAD>

<p><span style="color:#0000a0"><a style="font-size: 14pt">Examples of applications of VSNR. <a
    href="VSNR.zip">Download zip here.</a></span></span></p>


<BODY LANG="fr-FR" DIR="LTR">
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%%
BLONDE TEST</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>clear
all;close all;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Initializes the random number generator</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>rng(2);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Loads and normalizes image</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">im=double(imread(</FONT><FONT COLOR="#a020f0">'Blonde.png'</FONT><FONT COLOR="#000000">));</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>im=im/255;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Adds noisy lines to the image</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>sigma=0.3;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>imb=im;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>[nx,ny,m]=size(im);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#0000ff">for</FONT><FONT COLOR="#000000">
i=1:nx</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm;margin-left: 2em"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>  imb(i,:,1)=im(i,:,1)+sigma*randn;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm;margin-left: 2em"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>  imb(i,:,2)=im(i,:,2)+sigma*randn;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm;margin-left: 2em"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>  imb(i,:,3)=im(i,:,3)+sigma*randn;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#0000ff"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>end</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Display</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(1);image(uint8(255*imb));title(</FONT><FONT COLOR="#a020f0">'Noisy
image'</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><SPAN ID="Cadre1" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Blonde.png" NAME="images9" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Original
	image</I></FONT>
</SPAN>
<SPAN ID="Cadre2" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="BlondeNoisy.png" NAME="images10" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Noisy
	image</I></FONT>
</SPAN><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>

<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Defines the filter (a line)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>filter=zeros(size(im));</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>filter(1,:)=1/size(im,1);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Denoising algorithm</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>x=zeros(size(im));</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#0000ff">for</FONT><FONT COLOR="#000000">
i=1:3</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm;margin-left: 2em"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>ub=imb(:,:,i);
</FONT><FONT COLOR="#228b22">% Treats every components separately</FONT></FONT></FONT></P></dd>
<P STYLE="margin-bottom: 0cm;margin-left: 2em"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>[y,Gap1,Primal1,Dual1,EstP1,EstD1]=VSNR(ub,0,2,filter,4e-4,1e-3,1000);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm;margin-left: 2em"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>x(:,:,i)=y;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#0000ff"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>end</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Display the result (sometimes she will have a sunburst)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(2);image(uint8(255*x));title(</FONT><FONT COLOR="#a020f0">'Denoised
image'</FONT><FONT COLOR="#000000">);</FONT></FONT></FONT></P>

<P STYLE="margin-bottom: 0cm"><SPAN ID="Cadre3" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="BlondeNoisy.png" NAME="images11" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Noisy
	image (PSNR = 16,5dB)</I></FONT>
</SPAN>
<SPAN ID="Cadre4" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="BlondeDenoised.png" NAME="images12" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Denoised (PSNR = 32,3dB)</I></FONT>
</SPAN><BR>
</P>

<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><META NAME="CHANGEDBY" CONTENT="paw "><META NAME="CHANGEDBY" CONTENT="paw "><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%%
BABOON TEST</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Load and normalize image.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>clear
all;close all;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">im=double(imread(</FONT><FONT COLOR="#a020f0">'mandril_gray.tif'</FONT><FONT COLOR="#000000">))/255;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Seeds the random number generator (to produce identical experiments
each time)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>rng(3);
</FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
Generates noise patterns.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%
First, an isotropic sinc convolved with Gaussian noise.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">[ny,nx]=size(im);
</FONT><FONT COLOR="#228b22">% generates a sinc</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>[X,Y]=meshgrid(linspace(-1,1,nx),linspace(-1,1,ny));</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>R=100*sqrt(X.^2+Y.^2);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>psi1=sin(R)./(R+1e-10);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">psi1=1e-2*psi1/max(psi1(:));
</FONT><FONT COLOR="#228b22">% Normalization</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">b1=randn(size(im));
</FONT><FONT COLOR="#228b22">%Gaussian process</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">bpsi1=ifft2(fft2(b1).*fft2(psi1));
</FONT><FONT COLOR="#228b22">%convolution of b1 and psi1</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Second,
a Gabor function convolved with a Bernoulli process</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">psi2=gabor_fn(1,pi,0,0,1,0.05);
</FONT><FONT COLOR="#228b22">% a Gabor function</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">psi2=ZeroAdd(psi2,im);
</FONT><FONT COLOR="#228b22">%padds with zeros</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">psi2=1e-2*psi2/max(psi2(:));
</FONT><FONT COLOR="#228b22">%Normalization</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">b2=rand(size(im));
</FONT><FONT COLOR="#228b22">%generates a Bernoulli process</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>b2=double(b2&gt;0.999);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">bpsi2=ifft2(fft2(b2).*fft2(psi2));
</FONT><FONT COLOR="#228b22">%convolution of b2 with psi2</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Create
noisy imagge</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>imb=im+bpsi1+50*bpsi2;</FONT></FONT></FONT></P>


<P STYLE="margin-bottom: 0cm"><SPAN ID="Cadre1" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_real.png" NAME="images2" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Original
	image</I></FONT>
</SPAN>
<SPAN ID="Cadre2" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_Bruite.png" NAME="images1" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Noisy</I></FONT>
</SPAN><BR>
</P>

<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>

<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Stores
the filters in a single array.</FONT></FONT></FONT> 
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>Gabors=zeros(ny,nx,2);</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>Gabors(:,:,1)=psi1;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>Gabors(:,:,2)=psi2;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%%
Denoising and display</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Denoises
using a primal-dual algorithm.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Sets
parameters</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">p=[2,1];
</FONT><FONT COLOR="#228b22">%(indexes of p-norms)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">alpha=[0.12,0.05];
</FONT><FONT COLOR="#228b22">%data terms.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">epsilon
= 0; </FONT><FONT COLOR="#228b22">%no regularization of TV-norm</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">prec=
5e-3; </FONT><FONT COLOR="#228b22">%stopping criterion (initial dual
gap multiplied by prec)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">C
= 1; </FONT><FONT COLOR="#228b22">%ball-diameter to define a
restricted duality gap. </FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Main
algorithm</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>[u,Gap,Primal,Dual,EstP,EstD]=VSNR(imb,epsilon,p,Gabors,alpha,prec,C);</FONT></FONT></FONT></P>

<P STYLE="margin-bottom: 0cm"><SPAN ID="Cadre3" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_real.png" NAME="images2" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Original image</I></FONT>
</SPAN>
<SPAN ID="Cadre4" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_algo.png" NAME="images1" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Restored image</I></FONT>
</SPAN><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>


<P STYLE="margin-bottom: 0cm"></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Retrieving
noise components (EstP contains the estimation of noise processes)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>cp1=-ifft2(fft2(EstP(:,:,1)).*fft2(psi1));</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#000000"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>cp2=-ifft2(fft2(EstP(:,:,2)).*fft2(psi2));</FONT></FONT></FONT></P>

<P STYLE="margin-bottom: 0cm"><SPAN ID="Cadre5" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_real_B1.png" NAME="images2" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>First component</I></FONT>
</SPAN>
<SPAN ID="Cadre6" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_algo_B1.png" NAME="images1" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Retrieved first component</I></FONT>
</SPAN><BR>
</P>

<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>

<P STYLE="margin-bottom: 0cm"><SPAN ID="Cadre7" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_real_B2.png" NAME="images2" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Second component</I></FONT>
</SPAN>
<SPAN ID="Cadre8" DIR="LTR" STYLE="float: left; border: none; padding: 0cm; background: #ffffff">
	<IMG SRC="Baboon_algo_B2.png" NAME="images1" ALIGN=LEFT  WIDTH=256 HEIGHT=256 BORDER=0><BR CLEAR=LEFT><FONT SIZE=3><I>Retrieved 2nd component</I></FONT>
</SPAN><BR>
</P>

<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>

<P STYLE="margin-bottom: 0cm"><FONT COLOR="#228b22"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2>%Displaying
the whole</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(1);colormap
</FONT><FONT COLOR="#a020f0">gray</FONT><FONT COLOR="#000000">;imagesc(imb);title(</FONT><FONT COLOR="#a020f0">'Noisy
image'</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(2);colormap
</FONT><FONT COLOR="#a020f0">gray</FONT><FONT COLOR="#000000">;imagesc(u);title(</FONT><FONT COLOR="#a020f0">'Restored
image'</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewrter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(3);colormap
</FONT><FONT COLOR="#a020f0">gray</FONT><FONT COLOR="#000000">;imagesc(bpsi1);title(</FONT><FONT COLOR="#a020f0">'First
noise component - real'</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(4);colormap
</FONT><FONT COLOR="#a020f0">gray</FONT><FONT COLOR="#000000">;imagesc(cp1);title(</FONT><FONT COLOR="#a020f0">'First
noise component - estimated'</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(5);colormap
</FONT><FONT COLOR="#a020f0">gray</FONT><FONT COLOR="#000000">;imagesc(bpsi2);title(</FONT><FONT COLOR="#a020f0">'Second
noise component - real'</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="lucidatypewriter, monospace"><FONT SIZE=2><FONT COLOR="#000000">figure(6);colormap
</FONT><FONT COLOR="#a020f0">gray</FONT><FONT COLOR="#000000">;imagesc(cp2);title(</FONT><FONT COLOR="#a020f0">'Second
noise component - estimated'</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
</BODY>
</HTML>
